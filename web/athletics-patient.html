<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PredictWell — Athletics Patient Portal</title>
  <meta name="description" content="Athletics Patient Portal — daily workload & recovery check-ins." />
  <link rel="icon" href="data:," />

  <style>
    :root{
      --brand-bg:#0a2b4a;         /* deep navy */
      --brand-grad:#0f4d73;       /* lighter navy */
      --card:#143a57;             /* card surface */
      --text:#e9f2fb;             /* high-contrast text */
      --muted:#bcd0e5;            /* placeholder */
      --accent:#f4b000;           /* button (gold) */
      --accent-press:#d99a00;
      --ok:#47c17e;
      --error:#ff6767;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --pad: 22px;
      --field-h: 44px;
      --max-w: 760px;
    }

    /* Background image + overlay (same as Doctor Portal) */
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background-image: url("/static/images/predictwell_background.png");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
      position: relative;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background: linear-gradient(180deg, rgba(10,43,74,.95), rgba(15,77,115,.92));
      z-index:-1;
    }

    /* Header */
    .header{
      position:sticky; top:0;
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 22px;
      background: linear-gradient(90deg, rgba(10,43,74,.85), rgba(15,77,115,.85));
      backdrop-filter: blur(6px);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .brand{ display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text); }
    .brand .logo{ width:28px; height:28px; border-radius:8px; background:#fff1; display:inline-block }
    .brand span{ font-weight:700; letter-spacing:.2px }
    .nav a{
      color: var(--text); text-decoration:none; opacity:.85; margin-left:16px; font-size:14px;
    }
    .nav a:hover{ opacity:1 }

    /* Page title */
    .hero{ text-align:center; margin:36px 16px 14px }
    .hero h1{ margin:0; font-size:32px; font-weight:800 }
    .hero p{ margin:8px 0 0; opacity:.9 }

    /* Card */
    .card{
      width: min(100% - 32px, var(--max-w));
      margin: 14px auto 60px;
      background: linear-gradient(180deg, rgba(20,58,87,.86), rgba(20,58,87,.92));
      border: 1px solid rgba(255,255,255,.06);
      border-radius: var(--radius);
      padding: calc(var(--pad) + 2px);
      box-shadow: var(--shadow);
    }

    /* Form */
    .row{ display:flex; gap:14px; }
    .row > *{ flex:1 }
    label{ display:block; font-size:13px; margin:8px 2px; opacity:.9 }
    input, select, textarea, button{
      width:100%; box-sizing:border-box;
      height: var(--field-h);
      border-radius: 12px; border:1px solid rgba(255,255,255,.12);
      background:#0e2d48; color:var(--text); padding:0 12px; outline:none;
    }
    input::placeholder, textarea::placeholder{ color: var(--muted) }
    textarea{ height: 100px; padding:12px; resize:vertical }
    button{
      height: 46px; font-weight:700; letter-spacing:.2px; cursor:pointer;
      background: var(--accent); color:#111; border:none; margin-top:6px;
    }
    button:hover{ background: var(--accent-press) }

    .note{ font-size:13px; opacity:.85; margin-top:8px }
    .status{ margin-top:12px; font-size:14px }
    .status.ok{ color:var(--ok) }
    .status.err{ color:var(--error) }

    /* Footer */
    .footer{
      text-align:center; color:#cfe3f7cc; font-size:12px; padding:22px 10px 40px;
      border-top:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(10,43,74,.82), rgba(10,43,74,.92));
    }

    @media (max-width:640px){
      .row{ flex-direction:column }
      .hero h1{ font-size:26px }
    }
  </style>
</head>
<body>
  <!-- Header (matches Doctor Portal) -->
  <header class="header">
    <a class="brand" href="/index.html" aria-label="Home">
      <span class="logo"></span><span>PredictWell Health.ai</span>
    </a>
    <nav class="nav">
      <a href="/athletics.html">Doctors</a>
      <a href="/athletics-patient.html" style="font-weight:700; text-decoration:underline;">Patients</a>
      <a href="/eldercare.html">Eldercare</a>
    </nav>
  </header>

  <section class="hero">
    <h1>Athletics Patient Portal</h1>
    <p>Enter your daily workload and recovery metrics below.</p>
  </section>

  <main class="card">
    <form id="athPatientForm" novalidate>
      <div class="row">
        <div style="flex:2">
          <label for="name">Full Name</label>
          <input id="name" name="name" placeholder="Jane Doe" required />
        </div>
        <div>
          <label for="sleep">Hours Slept</label>
          <input id="sleep" name="sleep" placeholder="e.g., 7.5" inputmode="decimal" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="pitches">Pitch Count (if applicable)</label>
          <input id="pitches" name="pitches" placeholder="e.g., 42" inputmode="numeric" />
        </div>
        <div>
          <label for="pain">Pain Level</label>
          <select id="pain" name="pain">
            <option value="">Select Pain Level</option>
            <option value="0">0 — No pain</option>
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
            <option value="4">4</option><option value="5">5</option><option value="6">6</option>
            <option value="7">7</option><option value="8">8</option><option value="9">9</option>
            <option value="10">10 — Worst</option>
          </select>
        </div>
      </div>

      <div>
        <label for="notes">Additional Notes</label>
        <textarea id="notes" name="notes" placeholder="Soreness, workload, recovery, etc."></textarea>
      </div>

      <button type="submit">Submit</button>
      <div class="note">Submission sends to your PredictWell backend and returns a confirmation.</div>
      <div id="status" class="status" role="status" aria-live="polite"></div>
    </form>
  </main>

  <footer class="footer">
    © <span id="y"></span> PredictWell Health.ai — Athletics
  </footer>

  <script>
    const YEAR = new Date().getFullYear();
    document.getElementById('y').textContent = YEAR;

    // BACKEND: same pattern as Doctor Portal
    const BASE_API = 'https://predictwell-backend-ai.onrender.com';

    const form = document.getElementById('athPatientForm');
    const statusEl = document.getElementById('status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = 'Submitting...';
      statusEl.className = 'status';

      const payload = {
        name: form.name.value.trim(),
        sleep_hours: parseFloat(form.sleep.value || '0'),
        pitch_count: parseInt(form.pitches.value || '0', 10),
        pain_level: form.pain.value === '' ? null : parseInt(form.pain.value, 10),
        notes: form.notes.value.trim() || null
      };

      try {
        // Endpoint for simple patient log (mirrors doctor flow; safe to adjust later)
        const res = await fetch(`${BASE_API}/risk`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        statusEl.textContent = 'Thank you! Your entry was received.';
        statusEl.className = 'status ok';

        // Optional: show any risk score returned
        if (data && (data.risk || data.risk_score)) {
          statusEl.textContent += ` Risk score: ${data.risk ?? data.risk_score}`;
        }

        form.reset();
      } catch (err) {
        statusEl.textContent = 'Submission failed. Please try again.';
        statusEl.className = 'status err';
        console.error(err);
      }
    });
  </script>
</body>
</html>
