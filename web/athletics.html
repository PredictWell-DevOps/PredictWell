<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Athletics — Doctor Portal | PredictWell Health.ai</title>
  <meta name="description" content="Clinician/coach-facing Athletics Sentinel intake with quick risk, explain-why, and summary." />
  <link rel="icon" href="data:,">
  <style>
    :root{
      --brand:#12e3b4; --brand2:#5aa6ff; --ink:#0b1322; --muted:#5b6b7a;
      --card:#ffffffee; --line:#e8eef4; --radius:18px; --shadow:0 14px 38px rgba(0,0,0,.18);
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink)}
    a{color:inherit;text-decoration:none}
    body::before{content:"";position:fixed;inset:0;background-image:url("/static/images/predictwell_background.png");background-size:cover;background-position:center;filter:brightness(.92) saturate(.98);z-index:-2}
    body::after{content:"";position:fixed;inset:0;background:linear-gradient(180deg, rgba(255,255,255,.35) 0%, rgba(255,255,255,.45) 40%, rgba(255,255,255,.55) 100%);z-index:-1}
    .wrap{max-width:1180px;margin:0 auto;padding:0 20px}
    header{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,var(--brand) 0%,var(--brand2) 60%, #7aa4ff 100%);color:#062033;box-shadow:0 6px 20px rgba(0,0,0,.15)}
    .nav{display:flex;align-items:center;gap:22px;padding:12px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo{height:22px;width:22px;border-radius:8px;background:linear-gradient(135deg,var(--brand),var(--brand2));box-shadow:0 6px 18px rgba(18,227,180,.35)}
    .nav ul{display:flex;gap:20px;list-style:none;margin:0;padding:0}
    .spacer{flex:1}
    .email a{font-weight:800}
    main{padding:26px 0 40px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:26px}
    h1{margin:6px 0 6px;font-size:1.85rem}
    .muted{color:var(--muted)}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:1000px){.grid-3,.grid-2{grid-template-columns:1fr}}
    label{font-weight:700;font-size:.95rem}
    input,select,textarea{width:100%;padding:11px;border-radius:12px;border:1px solid #e1e7ef;background:#fafcff;color:#0b1322}
    textarea{min-height:90px;resize:vertical}
    .full{grid-column:1/-1}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 16px;border-radius:14px;border:1px solid transparent;font-weight:800;cursor:pointer;text-decoration:none}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:linear-gradient(135deg,var(--brand2),var(--brand));color:#07111f;box-shadow:0 10px 24px rgba(90,166,255,.25)}
    .btn-ghost{background:#f6f9fc;border:1px solid #e1e7ef;color:#0f1b2b}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#f3f7fb;border:1px solid #e1e7ef;font-weight:800}
    .result{display:none;margin-top:14px}
    footer{color:#2b3a48;padding:18px 0 40px;text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <nav class="nav" aria-label="Primary">
        <div class="brand"><div class="logo" aria-hidden="true"></div><span>PredictWell Health.ai</span></div>
        <ul>
          <li><a href="/#about">About</a></li>
          <li><a href="/#how">How It Works</a></li>
          <li><a href="/#services">Services</a></li>
          <li><a href="/#contact">Contact</a></li>
          <li><a href="/eldercare.html">Eldercare (Doctors)</a></li>
        </ul>
        <div class="spacer"></div>
        <div class="email">Email: <a href="mailto:hello@predictwellhealth.ai">hello@predictwellhealth.ai</a></div>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- Page intro -->
    <section class="card">
      <h1>Athletics — Doctor Portal</h1>
      <p class="muted">Coach/clinician intake for quick readiness & injury-risk orientation with explain-why factors.</p>
      <div class="row" style="margin-top:10px">
        <a class="btn btn-ghost" href="/">← Back to Home</a>
        <a class="btn btn-ghost" href="/athletics-patient.html">Open Patient Portal</a>
      </div>
    </section>

    <!-- Form -->
    <section style="margin-top:18px" class="card">
      <form id="form" class="grid-3">
        <div class="full"><strong>Athlete</strong></div>
        <div>
          <label>Sport / Position</label>
          <input id="position" placeholder="e.g., Baseball — Pitcher">
        </div>
        <div>
          <label>Level</label>
          <select id="level">
            <option>HS</option><option>College</option><option>Pro</option><option>Rec/Youth</option>
          </select>
        </div>
        <div>
          <label>Age</label>
          <input type="number" id="age" min="10" max="60" placeholder="e.g., 17">
        </div>

        <div class="full" style="margin-top:6px"><strong>Workload & Wellness</strong></div>
        <div>
          <label>Throws today (count)</label>
          <input type="number" id="throwsToday" min="0" max="500" placeholder="e.g., 35">
        </div>
        <div>
          <label>Last 7-day throws</label>
          <input type="number" id="throws7d" min="0" max="2000" placeholder="e.g., 220">
        </div>
        <div>
          <label>Sleep last night (h)</label>
          <input type="number" step="0.1" id="sleep" min="0" max="14" placeholder="e.g., 7.0">
        </div>
        <div>
          <label>Pain</label>
          <select id="pain"><option>none</option><option>mild</option><option>moderate</option><option>severe</option></select>
        </div>
        <div>
          <label>Fatigue</label>
          <select id="fatigue"><option>low</option><option>moderate</option><option>high</option></select>
        </div>
        <div>
          <label>Wellness (RPE 1–10)</label>
          <input type="number" id="rpe" min="1" max="10" placeholder="e.g., 6">
        </div>

        <div class="full" style="margin-top:6px"><strong>Flags (optional)</strong></div>
        <div>
          <label>Velocity change (mph)</label>
          <input type="number" id="veloDelta" step="0.1" placeholder="-1.5">
        </div>
        <div>
          <label>Mechanics flag</label>
          <select id="mech"><option value="none">None</option><option value="arm_slot">Arm slot drift</option><option value="timing">Late timing</option><option value="stride">Stride/landing</option></select>
        </div>
        <div>
          <label>Soreness zone</label>
          <select id="sore"><option value="none">None</option><option value="shoulder">Shoulder</option><option value="elbow">Elbow</option><option value="back">Back</option><option value="leg">Leg</option></select>
        </div>

        <div class="full">
          <label>Coach/clinician notes</label>
          <textarea id="notes" placeholder="Context, travel, illness, recent workload spike, mechanics comments, etc."></textarea>
        </div>

        <div class="full row" style="margin-top:6px">
          <button type="submit" class="btn btn-primary">Compute Risk</button>
          <button type="button" id="reset" class="btn btn-ghost">Reset</button>
        </div>
      </form>

      <!-- Result -->
      <div id="result" class="result">
        <div class="pill" id="riskBadge">Risk: —</div>
        <p id="summary" style="margin:.6rem 0 0"></p>
      </div>
    </section>
  </main>

  <footer class="wrap">© <span id="yr"></span> PredictWell Health — All rights reserved.</footer>

  <script>
    document.getElementById('yr').textContent = new Date().getFullYear();
    const BASE_API = 'https://predictwell-backend-ai.onrender.com';

    const form = document.getElementById('form');
    const resultBox = document.getElementById('result');
    const badge = document.getElementById('riskBadge');
    const summary = document.getElementById('summary');
    document.getElementById('reset').onclick = () => { form.reset(); resultBox.style.display='none'; };

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const p = {
        domain:'athletics',
        position: val('position') || null,
        level: val('level'),
        age: num('age'),
        throws_today: num('throwsToday'),
        throws_7d: num('throws7d'),
        sleep_hours: num('sleep'),
        pain: val('pain'),
        fatigue: val('fatigue'),
        rpe: num('rpe'),
        velo_delta: num('veloDelta'),
        mechanics_flag: val('mech'),
        soreness_zone: val('sore'),
        notes: val('notes') || null
      };

      let ok = false;
      try{
        const res = await fetch(`${BASE_API}/risk`,{
          method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(p)
        });
        if(res.ok){
          const data = await res.json(); // {risk_score, level, message}
          const level = data.level || levelFromScore(data.risk_score);
          render(level, data.message || autoMsg(p, level));
          ok = true;
        }
      }catch(_){}

      if(!ok){
        const level = localEstimate(p);
        render(level, autoMsg(p, level) + ' (quick estimate)');
      }
    });

    function val(id){ return document.getElementById(id).value.trim(); }
    function num(id){ const v = document.getElementById(id).value; return v===""?null:Number(v); }
    function levelFromScore(s){ if(s==null) return 'Unknown'; if(s>=0.66) return 'High'; if(s>=0.33) return 'Moderate'; return 'Low'; }

    function localEstimate(p){
      let score=0;
      if(p.throws_7d!=null && p.throws_today!=null && p.throws_today > Math.max(30, 0.35*p.throws_7d)) score+=0.25;
      if(p.pain==='moderate') score+=0.25; if(p.pain==='severe') score+=0.5;
      if(p.fatigue==='moderate') score+=0.15; if(p.fatigue==='high') score+=0.3;
      if(p.sleep_hours!=null && p.sleep_hours<6) score+=0.15;
      if(p.rpe!=null && p.rpe>=8) score+=0.15;
      if(p.velo_delta!=null && p.velo_delta<=-1) score+=0.15;
      if(p.mechanics_flag!=='none') score+=0.1;
      if(score>=0.66) return 'High'; if(score>=0.33) return 'Moderate'; return 'Low';
    }

    function autoMsg(p, level){
      const bits=[];
      if(p.pain==='moderate'||p.pain==='severe') bits.push('current pain');
      if(p.fatigue!=='low') bits.push('fatigue');
      if(p.sleep_hours!=null && p.sleep_hours<6) bits.push('short sleep');
      if(p.throws_today!=null && p.throws_7d!=null && p.throws_today>Math.max(30,0.35*p.throws_7d)) bits.push('workload spike');
      if(p.velo_delta!=null && p.velo_delta<=-1) bits.push('velo drop');
      if(p.mechanics_flag!=='none') bits.push('mechanics flag');
      const because = bits.length?` Because of ${bits.join(', ')}.`:'';
      return `Orientation: **${level}**.${because} Consider workload cap, mechanics review, and recovery focus; escalate if pain persists.`;
    }

    function render(level,msg){
      badge.textContent = `Risk: ${level}`;
      summary.innerHTML = msg;
      resultBox.style.display='block';
      resultBox.scrollIntoView({behavior:'smooth',block:'start'});
    }
  </script>
</body>
</html>
