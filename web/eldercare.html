<!-- ====== eldercare.html — DOCTOR PORTAL (Modern, 2-col, collapsible) ====== -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PredictWell Health.ai — Eldercare Doctor Portal</title>
  <meta name="description" content="Eldercare Sentinel — Doctor intake with vitals, meds, labs, cognition, and activity for AI risk insights." />
  <link rel="icon" href="data:,">

  <style>
    :root{
      --bg: rgba(0,0,0,0.45);
      --card: rgba(255,255,255,0.92);
      --shadow: 0 10px 30px rgba(0,0,0,0.20);
      --radius: 18px;
      --space: 16px;
      --brand: #0b5fff;
      --brand2:#0aa0ff;
      --accent:#ff7a00;
      --accent2:#ffb24d;
      --text:#0b1b2b;
      --muted:#5b6b7c;
      --ok:#10b981;
      --err:#ef4444;
      --chip:#edf2ff;
    }

    /* Background */
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--text);
      background-image: url("/static/images/predictwell_background.png");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
    }
    /* Overlay to improve contrast */
    .overlay{
      position: fixed; inset:0; background: radial-gradient(1200px 800px at 70% 20%, rgba(255,255,255,0.06), rgba(0,0,0,0.45));
      pointer-events:none;
    }

    /* Header */
    .header{
      position: sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,0.65);
      border-bottom: 1px solid rgba(255,255,255,0.4);
    }
    .nav{
      max-width: 1100px; margin: 0 auto; padding: 14px 18px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .brand{ display:flex; gap:10px; align-items:center; text-decoration:none; color:inherit;}
    .logo{
      width:36px; height:36px; border-radius:10px;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: var(--shadow);
    }
    .title{ font-weight:700; font-size:18px; line-height:1.1}
    .subtitle{ font-size:12px; color:var(--muted); margin-top:2px}
    .menu-btn{
      appearance:none; border:0; background:#fff; width:40px; height:40px; border-radius:12px;
      display:grid; place-items:center; box-shadow:var(--shadow); cursor:pointer;
    }
    .menu-dot{ width:18px; height:2px; background:#111; position:relative; border-radius:2px}
    .menu-dot::before,.menu-dot::after{ content:""; position:absolute; width:18px; height:2px; background:#111; left:0; border-radius:2px}
    .menu-dot::before{ top:-6px } .menu-dot::after{ top:6px }

    .menu{
      position:absolute; right:18px; top:60px; background:#fff; border-radius:14px; box-shadow:var(--shadow);
      display:none; min-width:240px; overflow:hidden;
    }
    .menu a{
      display:flex; justify-content:space-between; align-items:center;
      padding:12px 14px; text-decoration:none; color:#0b1b2b; font-weight:600;
      border-bottom:1px solid #f1f5f9;
    }
    .menu a small{ color:var(--muted); font-weight:500}
    .menu a:last-child{ border-bottom:0 }
    .menu.show{ display:block }

    /* Page container */
    .wrap{ max-width:1100px; margin:22px auto 80px; padding: 0 18px;}

    /* Hero card */
    .hero{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 20px;
      display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .hero h1{ margin:0; font-size:22px }
    .hero p{ margin:6px 0 0; color:var(--muted) }

    /* Grid layout */
    .grid{
      display:grid; grid-template-columns: 2fr 1fr; gap: 18px; margin-top:18px;
    }
    .card{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    /* Collapsible sections */
    details{
      background:#fff; border-radius:14px; margin-bottom:12px; border: 1px solid #eef2f7; overflow:hidden;
    }
    details[open] { border-color:#dbeafe; box-shadow:0 8px 16px rgba(2,132,199,0.10) }
    summary{
      list-style:none; cursor:pointer; padding:14px 16px; font-weight:700; display:flex; align-items:center; justify-content:space-between;
      background: linear-gradient(180deg,#ffffff,#f8fafc);
    }
    summary::-webkit-details-marker{ display:none }
    .section-body{ padding: 14px 16px 16px; border-top:1px solid #eef2f7; background:#fff }

    /* Form layout */
    .row{ display:grid; grid-template-columns: repeat(12, 1fr); gap:12px; }
    .col-6{ grid-column: span 6 } .col-4{ grid-column: span 4 } .col-3{ grid-column: span 3 } .col-12{ grid-column: span 12 }
    label{ font-size:12px; color:var(--muted); display:block; margin-bottom:6px; }
    input, select, textarea{
      width:100%; padding:12px 12px; border:1px solid #e2e8f0; border-radius:12px; background:#fff; font-size:14px;
    }
    textarea{ min-height:110px; resize:vertical }
    .chip{ font-size:12px; padding:4px 8px; background:var(--chip); border-radius:999px; display:inline-block; margin-right:8px; }

    /* Right column results */
    .results pre{
      background:#0b1220; color:#eaf2ff; padding:14px; border-radius:12px; overflow:auto; font-size:12px; line-height:1.4;
    }

    /* Buttons */
    .btn{
      border:0; padding:12px 16px; border-radius:14px; font-weight:800; cursor:pointer; letter-spacing:.2px;
      color:#fff; box-shadow: var(--shadow);
    }
    .btn-blue{ background: linear-gradient(135deg, var(--brand), var(--brand2)); }
    .btn-orange{ background: linear-gradient(135deg, var(--accent), var(--accent2)); }
    .btn-ghost{ background:#fff; color:#0b1b2b; border:1px solid #e2e8f0 }
    .btn-row{ display:flex; flex-wrap:wrap; gap:10px; margin-top:12px }

    .muted{ color:var(--muted) }
    .ok{ color: var(--ok); font-weight:700 }
    .err{ color: var(--err); font-weight:700 }

    /* Mobile */
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr }
      .hero{ flex-direction:column; align-items:flex-start }
    }
    @media (max-width: 640px){
      .row{ grid-template-columns: repeat(6, 1fr) }
      .col-6{ grid-column: span 6 } .col-4{ grid-column: span 6 } .col-3{ grid-column: span 3 } .col-12{ grid-column: span 6 }
    }
  </style>
</head>
<body>
  <div class="overlay" aria-hidden="true"></div>

  <!-- Header -->
  <header class="header">
    <nav class="nav">
      <a class="brand" href="/"><div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">PredictWell Health.ai</div>
          <div class="subtitle">Proactive health insights for seniors & athletes</div>
        </div>
      </a>

      <button id="hamburger" class="menu-btn" aria-label="Open menu"><span class="menu-dot"></span></button>
      <div id="menu" class="menu" role="menu" aria-label="Site menu">
        <a href="/eldercare.html">Eldercare Doctors <small>Doctor portal</small></a>
        <a href="/eldercare-patient.html">Eldercare Patients <small>Quick check-in</small></a>
        <a href="/athletics.html">Athletics Doctors <small>Pitching risk</small></a>
        <a href="/athletics-patient.html">Athletics Patients <small>Quick risk</small></a>
      </div>
    </nav>
  </header>

  <main class="wrap">
    <!-- Intro -->
    <section class="hero">
      <div>
        <h1>Eldercare Sentinel — Doctor Intake</h1>
        <p>Modernized clinical intake for seniors. Submit vitals, meds, labs, cognition, and activity; we’ll compute risk signals and suggested micro-actions.</p>
      </div>
      <div>
        <span class="chip">Doctor Portal</span>
        <span class="chip">AI Risk Engine</span>
        <span class="chip">HIPAA-friendly design</span>
      </div>
    </section>

    <!-- Content -->
    <section class="grid">
      <!-- LEFT: Form -->
      <form id="doctorForm" class="card">
        <!-- Patient & Visit -->
        <details open>
          <summary>Patient & Visit</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-6">
                <label>Patient name</label>
                <input name="name" placeholder="e.g., Pat Quinn" />
              </div>
              <div class="col-3">
                <label>Age</label>
                <input name="age" type="number" inputmode="numeric" placeholder="79" />
              </div>
              <div class="col-3">
                <label>Sex</label>
                <select name="sex">
                  <option value="">Select</option>
                  <option>Female</option>
                  <option>Male</option>
                  <option>Intersex / Other</option>
                  <option>Prefer not to say</option>
                </select>
              </div>

              <div class="col-4">
                <label>Height (in)</label>
                <input name="height_in" type="number" step="0.1" placeholder="66" />
              </div>
              <div class="col-4">
                <label>Weight (lbs)</label>
                <input name="weight_lbs" type="number" step="0.1" placeholder="168" />
              </div>
              <div class="col-4">
                <label>Recent weight change (lbs)</label>
                <input name="weight_change_lbs" type="number" step="0.1" placeholder="0" />
              </div>
            </div>
          </div>
        </details>

        <!-- Vitals -->
        <details open>
          <summary>Vitals</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-3">
                <label>Resting HR (bpm)</label>
                <input name="resting_hr" type="number" placeholder="68" />
              </div>
              <div class="col-3">
                <label>Avg nightly SpO₂ (%)</label>
                <input name="spo2" type="number" step="0.1" placeholder="94.5" />
              </div>
              <div class="col-3">
                <label>BP (systolic)</label>
                <input name="bp_sys" type="number" placeholder="128" />
              </div>
              <div class="col-3">
                <label>BP (diastolic)</label>
                <input name="bp_dia" type="number" placeholder="78" />
              </div>

              <div class="col-3">
                <label>Respiratory rate</label>
                <input name="rr" type="number" step="0.1" placeholder="16" />
              </div>
              <div class="col-3">
                <label>Temp (°F)</label>
                <input name="temp_f" type="number" step="0.1" placeholder="98.2" />
              </div>
              <div class="col-3">
                <label>Glucose (fasting)</label>
                <input name="glucose" type="number" step="0.1" placeholder="92" />
              </div>
              <div class="col-3">
                <label>A1c (%)</label>
                <input name="a1c" type="number" step="0.1" placeholder="5.7" />
              </div>
            </div>
          </div>
        </details>

        <!-- Sleep & Activity -->
        <details>
          <summary>Sleep & Activity</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-3">
                <label>Avg sleep (hrs)</label>
                <input name="sleep_hours" type="number" step="0.1" placeholder="6.7" />
              </div>
              <div class="col-3">
                <label>Avg daily steps</label>
                <input name="daily_steps" type="number" placeholder="4200" />
              </div>
              <div class="col-3">
                <label>HRV rMSSD (ms)</label>
                <input name="hrv_rmssd" type="number" placeholder="18" />
              </div>
              <div class="col-3">
                <label>Sleep efficiency (%)</label>
                <input name="sleep_eff" type="number" step="0.1" placeholder="84" />
              </div>
            </div>
          </div>
        </details>

        <!-- Balance, Mobility, Cognition -->
        <details>
          <summary>Balance, Mobility & Cognition</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-12">
                <label>Screening flags</label>
                <div class="row">
                  <div class="col-6"><label><input type="checkbox" name="flag_balance" /> Recent balance, gait, or dizziness issues</label></div>
                  <div class="col-6"><label><input type="checkbox" name="flag_memory" /> Memory/attention/mood flags</label></div>
                  <div class="col-6"><label><input type="checkbox" name="flag_falls" /> Fall in last 7 days</label></div>
                  <div class="col-6"><label><input type="checkbox" name="flag_er" /> ER/hospital visit</label></div>
                </div>
              </div>
              <div class="col-12">
                <label>Notes (optional)</label>
                <textarea name="cognition_notes" placeholder="Observations, MoCA/MMSE notes, functional changes…"></textarea>
              </div>
            </div>
          </div>
        </details>

        <!-- Medications & Conditions -->
        <details>
          <summary>Medications & Conditions</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-12">
                <label>Current medications</label>
                <textarea name="medications" placeholder="Name, dose, frequency. Mark high-risk meds (e.g., benzos, anticholinergics), anticoagulants, insulin, etc."></textarea>
              </div>
              <div class="col-12">
                <label>Chronic conditions</label>
                <textarea name="conditions" placeholder="E.g., AFib, CHF, COPD, CKD, CAD, DM2, dementia, Parkinson’s, depression, osteoporosis…"></textarea>
              </div>
              <div class="col-12">
                <label>Allergies</label>
                <textarea name="allergies" placeholder="Allergen — reaction — severity"></textarea>
              </div>
            </div>
          </div>
        </details>

        <!-- Key Labs -->
        <details>
          <summary>Key Labs</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-3"><label>Na (mEq/L)</label><input name="lab_na" type="number" step="0.1" /></div>
              <div class="col-3"><label>K (mEq/L)</label><input name="lab_k" type="number" step="0.1" /></div>
              <div class="col-3"><label>Creatinine</label><input name="lab_cr" type="number" step="0.01" /></div>
              <div class="col-3"><label>eGFR</label><input name="lab_egfr" type="number" /></div>
              <div class="col-3"><label>BNP/NT-proBNP</label><input name="lab_bnp" type="number" /></div>
              <div class="col-3"><label>Hgb (g/dL)</label><input name="lab_hgb" type="number" step="0.1" /></div>
              <div class="col-3"><label>TSH</label><input name="lab_tsh" type="number" step="0.1" /></div>
              <div class="col-3"><label>CRP</label><input name="lab_crp" type="number" step="0.1" /></div>
            </div>
          </div>
        </details>

        <!-- Devices / Wearables -->
        <details>
          <summary>Devices & Wearables</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-6">
                <label>Primary wearable</label>
                <input name="wearable" placeholder="Apple Watch / Fitbit / Oura / Garmin / Other" />
              </div>
              <div class="col-6">
                <label>CPAP / O₂</label>
                <input name="cpap_o2" placeholder="e.g., CPAP nightly, 2 L O₂ PRN" />
              </div>
              <div class="col-12">
                <label>Device notes</label>
                <textarea name="device_notes" placeholder="Adherence, issues, sensor problems, data gaps…"></textarea>
              </div>
            </div>
          </div>
        </details>

        <!-- Free-text Clinical Notes -->
        <details>
          <summary>Clinical Notes</summary>
          <div class="section-body">
            <div class="row">
              <div class="col-12">
                <label>Visit notes</label>
                <textarea name="notes" placeholder="Chief concerns, ROS highlights, exam pearls, pending referrals, caregiver insights…"></textarea>
              </div>
            </div>
          </div>
        </details>

        <div class="btn-row">
          <button type="button" id="submitBtn" class="btn btn-blue">Submit to AI Risk Engine</button>
          <a class="btn btn-orange" href="/eldercare-patient.html">Go to Patient Portal</a>
          <button type="button" id="pingBtn" class="btn btn-ghost">Ping Backend</button>
        </div>
        <p id="statusMsg" class="muted" role="status" style="margin-top:8px;"></p>
      </form>

      <!-- RIGHT: Results -->
      <aside class="card results">
        <h3 style="margin-top:0">Results</h3>
        <p class="muted" style="margin-top:-6px">Model response and suggested micro-actions will appear here.</p>
        <pre id="resultBox">{ "status": "ok" }</pre>
        <p class="muted" style="font-size:12px">Tip: keep sections collapsed you don’t need; everything saves in the same submission.</p>
      </aside>
    </section>
  </main>

  <script>
    // ---- Config
    const BASE_API = 'https://predictwell-backend-ai.onrender.com';

    // ---- Menu
    const menuBtn = document.getElementById('hamburger');
    const menu = document.getElementById('menu');
    menuBtn.addEventListener('click', () => menu.classList.toggle('show'));
    document.addEventListener('click', (e)=> {
      if(!menu.contains(e.target) && !menuBtn.contains(e.target)) menu.classList.remove('show');
    });

    // ---- Helpers
    function formToJSON(form) {
      const data = {};
      new FormData(form).forEach((v, k) => {
        if (data[k] !== undefined) {
          if (!Array.isArray(data[k])) data[k] = [data[k]];
          data[k].push(v);
        } else {
          data[k] = v;
        }
      });
      // Convert checkboxes to booleans
      ['flag_balance','flag_memory','flag_falls','flag_er'].forEach(key=>{
        data[key] = !!form.querySelector(`[name="${key}"]`)?.checked;
      });
      return data;
    }

    const form = document.getElementById('doctorForm');
    const statusMsg = document.getElementById('statusMsg');
    const resultBox = document.getElementById('resultBox');

    async function pingBackend(){
      try{
        statusMsg.textContent = 'Pinging backend…';
        const r = await fetch(`${BASE_API}/healthz`);
        const j = await r.json();
        statusMsg.innerHTML = '<span class="ok">Backend online.</span>';
        resultBox.textContent = JSON.stringify(j, null, 2);
      }catch(e){
        statusMsg.innerHTML = '<span class="err">Backend unreachable.</span>';
      }
    }

    async function submitDoctor(){
      statusMsg.textContent = 'Submitting…';
      const payload = formToJSON(form);
      try{
        const r = await fetch(`${BASE_API}/eldercare/checkin`, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
        const j = await r.json();
        resultBox.textContent = JSON.stringify(j, null, 2);
        statusMsg.innerHTML = '<span class="ok">Submitted successfully.</span>';
      }catch(e){
        statusMsg.innerHTML = '<span class="err">Submission failed.</span>';
      }
    }

    document.getElementById('pingBtn').addEventListener('click', pingBackend);
    document.getElementById('submitBtn').addEventListener('click', submitDoctor);
  </script>
</body>
</html>
